# shell编程

[TOC]

## 初识

* `set`：查看当前shell中所有的变量

## 变量

> 字母、数字和下划线组成，不能以数字开头
>
> **等号两侧 不能有空格**
>
> 变量名一般习惯为大写
>
> 双引号和单引号有区别，双引号仅将空格脱意，单引号将所有特殊字符脱意。

* 定义变量：`变量=值`
* 撤销变量：`unset 变量`
* 声明静态变量：`readonly 变量=值`

## 命令的返回值赋值给变量

1. ```bash
   RET=`ls -al` # 使用反引号，运行反引号里面的命令，结果返回给ret，等号两边不要加空格
   ```

2. ```bash
   RET=$(ls -al) # 等价于上面的方式
   ```

## 设置环境变量

1. `export 变量名=变量值`，设置环境变量
2. `source 配置文件`，让修改后的配置信息立即生效
3. `echo $变量名`，查询环境变量的值

## 位置参数变量

1. `$n`：`n`表示数字，`$0`表示命令本身，`$1-$9`代表第一个到第九个参数，十个以上的参数，需要用大括号括起来，例：`${10}`；
2. `$*`：代表命令行中所有的参数，`$*`把所有的参数看做一个整体；
3. `$@`：代表命令行中所有的参数，`$@`把每个参数区分对待；
4. `$#`：代表命令行中所有参数的个数。
5. `$$`：当前进程号
6. `$!`：后台运行的最后一个进程的进程号
7. `$?`：最后一次执行的命令的返回状态，如果为`0`表示成功执行，否则为失败。

## 运算符

1. `$((运算式))`或者`$[运算式]`，乘法：`*`

2. `expr m + n`，注意：`expr`运算符间要有空格，乘法：`\*`

3. `expr m - n`，注意：`expr`运算符间要有空格，乘法：`\*`

4. `*， /， %`

   ```bash
    r=`expr 4 \* 2` && echo $r  # 很难用，建议不用
    a=$[10 - 1] && echo $a
    echo $((4 - 1))
   ```

## 条件判断

> `[ condition ]`，注意condition前后需要有空格
>
> 只要`[]`里面有内容就会返回true，否则`[]`而会返回false。

### 两个整数之间比较判断

1. `=`：字符串比较
2. `-lt`：小于，`less than`
3. `-le`：小于等于，`less than or -equal`
4. `-eq`：等于，`equal`
5. `-gt`：大于，`greater than`
6. `-ge`：大于等于，`greater than or equal`
7. `-ne`：不等于，`not equal`

### 文件权限判断

1. `-r`：有读权限
2. `-w`：有写权限
3. `-x`：有执行权限

### 文件类型判断

1. `-r`：文件存在并且是一个常规的文件
2. `-e`：文件存在
3. `-d`：文件存在并且是一个目录

## 流程控制

1. `if`判断

   1. ```bash
      if [ 条件判断式 ];then
      	程序
      fi
      ```

   2. ```bash
      if [ 条件判断式 ]
        then
      	程序
      fi
      ```

      PS：`[ 条件判断式 ]`，中括号和条件判断式之间必须有空格

      ```bash
      #!/bin/bash
      
      if [ $1 -eq "123" ];then
          echo "is 123"
      elif [ $1 -eq "456" ];then
          echo "is 456"
      fi
      ```

2. `case`语句

3. `for`循环

4. `while`循环