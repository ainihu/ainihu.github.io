# 函数内部功能分析

1. 分析参数

2. 分析局部变量

3. 分析全局变量

4. 功能分析

## 内存五区

![内存五区](./Picture/内存五区.png)

## 局部变量的识别

> 通过[ebp - X]来识别。

## 全局变量的识别

> 通过内存地址直接寻值的一般是全局变量

## 参数的识别

>三种常用的`Call`
>
>1. 不考虑ebp、esp；
>2. 只找别人给赋值的寄存器`eax/ecx/edx/ebx/esi/edi`；
>3. 找到以后追查其来源，如果，该寄存器中的值不是在函数内存赋值的，那一定是传进来的参数；
>4. 常见的`ebp + X`为参数。
>
>公式一：`寄存器 + ret 4 = 参数个数`
>
>公式二：`寄存器 + [ebp + 8] + [ebp + 0x] = 参数个数`

