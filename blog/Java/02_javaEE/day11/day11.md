# day11

## Mybatis的延迟加载

### 需要延迟加载的问题提出？

> 在一对多中，当我们有一个用户，它有100个账户。
>
> - 在查询用户的时候，要不要把关联的账户查出来？
>
> - 在查询账户的时候，要不要把关联的用户查出来？

### 延迟加载

> 在真正使用数据时才发起查询，不用的时候不查询，按需加载(懒加载)。

### 立即加载

> 不管用不用，只要一调用，马上发起查询。

### 四种表关系对应的加载策略

> 一对多、多对一、一对一和多对多；
>
> 延迟加载：一对多，多对多；
>
> 立即加载：多对一，一对一。

## 如何实现Mybatis的延迟加载

> 1. 配置开启延迟加载；
> 2. 配置延迟加载`Dao`文件。

## Mybatis的缓存

> 存储在内存中的临时数据。

### 为什么使用缓存

> 减少和数据库的交互次数，提高执行效率。

### 使用缓存的条件

> - 可以使用缓存：
>
>   1. 经常查询并且不经常改变的；
>   2. 数据的正确与否结果影响不大。
>
> - 不适用于缓存：
>
>   1. 经常改变的数据；
>   2. 数据的正确与否对最终结果影响很大。
>
>   > 如：商品的库存、银行的汇率和股市的价格。

## Mybatis的一级缓存和二级缓存

> - 一级缓存：
>
>   > 它指的是`Mybatis`中`SqlSession`对象的缓存，当执行查询之后，查询的记过会同时存入到`SqlSession`为我们提供的一块区域中，该区域是一个`Map`结构，当查取一个的数据时，`Mybatis`会现在`SqlSession`中查询是否有，如果有则直接取出数据。当`SqlSession`对象消失时，`Mybatis`的一级缓存也就消失了。
>
> - 二级缓存
>
>   > 它指的是`Mybatis`中`SqlsessionFactory`对象的缓存，由同一个`SqlSessionFactory`对象创建的`SqlSession`共享其缓存。
>
>   - 二级缓存使用步骤：
>     1. 设置`Mybatis`框架开启二级缓存，在`SqlMapConfig.xml`中配置信息；
>     2. 让当前的映射文件支持二级缓存，在`*Dao.xml`文件中配置；
>     3. 让当前的操作支持二级缓存，在`select`标签中配置。

## Mybatis注解开发

